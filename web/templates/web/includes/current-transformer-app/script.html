{% load static %}
<script src="{% static 'vendor/js/gauge/gauge.min.js' %}"></script>
<script>
    let opts = {
        angle: 0.15, // The span of the gauge arc
        lineWidth: 0.44, // The line thickness
        radiusScale: 1, // Relative radius
        pointer: {
            length: 0.6, // // Relative to gauge radius
            strokeWidth: 0.035, // The thickness
            color: '#000000' // Fill color
        },
        limitMax: false,     // If false, max value increases automatically if value > maxValue
        limitMin: false,     // If true, the min value of the gauge will be fixed
        colorStart: '#6FADCF',   // Colors
        colorStop: '#8FC0DA',    // just experiment with them
        strokeColor: '#E0E0E0',  // to see which ones work best for you
        generateGradient: true,
        highDpiSupport: true,     // High resolution support
        percentColors: [[0.0, "#a9d70b"], [0.50, "#f9c802"], [1.0, "#ff0000"]],

    };


    let current_transformer = "{{current_transformer_s|escapejs}}"
    // let i_a_values = JSON.parse(`{{i_a_values_s|escapejs}}`)
    // let i_b_values = JSON.parse(`{{i_b_values_s|escapejs}}`)
    // let i_c_values = JSON.parse(`{{i_c_values_s|escapejs}}`)
    let animationSpeed = 10

    let current_transformer_app = new Vue({
        el: "#current-transformer-app",
        data: {
            values: [],
            current_transformer: current_transformer,
            i_a: 190,
            i_b: 170,
            i_c: 180,
            ratio: 350,
        },
        methods: {

            draw_guage_charts: function () {
                try {
                    let ratio = this.ratio
                    let current_transformer = this.current_transformer

                    console.log("aaaaa 11111 ")
                    var target_a = document.getElementById("canvas-current-transformer-a")
                    var gauge_a = new Gauge(target_a).setOptions(opts); // create sexy gauge!
                    gauge_a.maxValue = ratio * 1.3; // set max gauge value
                    gauge_a.setMinValue(0);  // Prefer setter over gauge.minValue = 0
                    gauge_a.animationSpeed = animationSpeed; // set animation speed (32 is default value)
                    gauge_a.set(this.i_a); // set actual value


                    

                    console.log("aaaaa 11111 ")
                    var target_b = document.getElementById("canvas-current-transformer-b")
                    var gauge_b = new Gauge(target_b).setOptions(opts); // create sexy gauge!
                    gauge_b.maxValue = ratio * 1.3; // set max gauge value
                    gauge_b.setMinValue(0);  // Prefer setter over gauge.minValue = 0
                    gauge_b.animationSpeed = animationSpeed; // set animation speed (32 is default value)
                    gauge_b.set(this.i_b); // set actual value



                    
                    console.log("aaaaa 11111 ")
                    var target_c = document.getElementById("canvas-current-transformer-c")
                    var gauge_c = new Gauge(target_c).setOptions(opts); // create sexy gauge!
                    gauge_c.maxValue = ratio * 1.3; // set max gauge value
                    gauge_c.setMinValue(0);  // Prefer setter over gauge.minValue = 0
                    gauge_c.animationSpeed = animationSpeed; // set animation speed (32 is default value)
                    gauge_c.set(this.i_c); // set actual value



                    

                   



                } catch (error) {

                }

            },

            update_values: function () {
                if (this.values.length > 0)
                    this.i_a = this.values[0].i_a

                if (this.values.length > 0)
                    this.i_b = this.values[0].i_b

                if (this.values.length > 0)
                    this.i_c = this.values[0].i_c

                this.draw_guage_charts()
            },
        }
    })
</script>